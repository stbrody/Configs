#!/bin/bash

set -e

jiraUsername="spencer"
emailAddress="spencer@10gen.com"

msg="$1" # capture review message
shift # Remove review message from argument list
gitstuff="$@" # capture the rest of the arguments, which are about what git diff to use

# If we specify --rev then pass that directly into git diff, else assume its just a single git hash
# and create the diff between it and the hash immediately preceeding it.
if [[ $gitstuff != *"--rev="* ]]
then
    gitstuff="$gitstuff^ $gitstuff"
fi

python ~/10gen/kernel-tools/codereview/upload.py -y --check-clang-format --check-eslint \
    --git_similarity=99 --jira_user $jiraUsername --email $emailAddress -m "$msg" $gitstuff
