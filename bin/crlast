#!/bin/bash

set -e

jiraUsername="spencer"
emailAddress="spencer@10gen.com"

# get the commit message
msg=`git log -1 --oneline | cut -d' ' -f2-`
hash=`git rev-parse HEAD`

if [[ $# -eq 0 ]]; then
   # just last commit
   python ~/10gen/kernel-tools/codereview/upload.py -y --check-clang-format \
       --jira_user $jiraUsername --email $emailAddress -m "$msg" $hash^ $hash
else
   # issue given
   issue=$1

   python ~/10gen/kernel-tools/codereview/upload.py --nojira -y --check-clang-format \
       --git_similarity=99 --email $emailAddress -m "$msg" -i $issue $hash^ $hash
fi
